{% extends 'base.html' %}
{% load bbstags %}

{% block title %}
    Contests
{% endblock title %}


{% block content %}
  <div class="container">
    <div class="page-header">
      <h1>Contest Results</h1>
    </div>


    {% if performances %}
      {% regroup performances by contest as contest_list %}
      {% for contest in contest_list %}
        <div class='panel panel-default'>
          <div class="panel-heading">
            <h2 class='panel-title'><a data-toggle='collapse' href='#{{contest.grouper|cut:" "}}'>{{contest.grouper}}</a></h2>
          </div>
          <div class="panel-collapse collapse {% ifequal contest.grouper.id 3 %} in {% else %} out {% endifequal%}" id="{{contest.grouper|cut:" "}}">
            <div class="panel-body">
              {% regroup contest.list by get_contest_round_display as performance_list %}
              {% for performance in performance_list %}
                <h3>{{performance.grouper}}</h3>


                <div class="table-responsive">
                  <table class='table'>
                    <tr>
                      <th>Place</th>
                      <th>Contestant</th>
                      <th>Songs</th>
                      <th>MUS</th>
                      <th>PRS</th>
                      <th>SNG</th>
                      <th>Song</th>
                      {# <th>ALL</th> #}
                    </tr>
                    {% for item in performance.list %}
                      <tr>
                        <td>{{item.place}}</td>
                        <td> <a href='{% url "contestant" item.contestant.slug %}'>{{item.contestant.name}} ({{item.contestant.get_district_display}})</a></td>
                        <td class='small'>{{item.song1|truncatechars:25}}<br>{{item.song2|truncatechars:25}}</td>
                        <td class='small'> {{item.mus1_rata|floatformat:1}}<br>{{item.mus2_rata|floatformat:1}}</td>
                        <td class='small'> {{item.prs1_rata|floatformat:1}}<br>{{item.prs2_rata|floatformat:1}}</td>
                        <td class='small'> {{item.sng1_rata|floatformat:1}}<br>{{item.sng2_rata|floatformat:1}}</td>
                        <td class='small'> {{item.song1_rata|floatformat:1}}<br>{{item.song2_rata|floatformat:1}}</td>
                        {# <td> {{item.contestant.grand|floatformat:1}}</td> #}
                      </tr>
                    {% endfor %}
                  </table>
                </div>
              {% endfor %}
              {% if contest.grouper.scoresheet %}
                <a href='{{contest.grouper.scoresheet.url}}'>Download Official Scoresheet</a>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class='lead'>There are no results yet.  We'll post them here as soon as they are available.</p>
    {% endif %}
        {% regroup performances by contestant as clist %}
    {% for c in clist %}
      <h3>{{c.grouper}}</h3>
      {% for item in c.list %}
        {{item.song1}}
      {% endfor %}
    {% endfor %}


  </div>
{% endblock content %}