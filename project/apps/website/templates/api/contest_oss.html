{% extends 'base.html' %}
{% load humanize %}

{% block content %}
  <main class="container">
    <section>
      <h4>
        Contest Scoring Summary: {{contest}}<br>
      </h4>
    </section>
    <section>
      <div class='table-responsive'>
        <table class='table'>
          <thead>
            <tr>
              <th>Place</th>
              <th>Total</th>
              <th>Group</th>
              <th>Song</th>
              <th>MUS</th>
              <th>PRS</th>
              <th>SNG</th>
              <th>TOT</th>
              <th>M%</th>
              <th>P%</th>
              <th>S%</th>
              <th>T%</th>
            </tr>
          </thead>
          <tbody>
            {% for contestant in contestants %}
              <tr>
                <td>
                  {{contestant.place}}
                </td>
                <td>
                  {{contestant.total_points}}<br>
                  {{contestant.total_score}}<br>
                </td>
                <td>
                  {{contestant.performer.group.name}} {% if contestant.performer.group.organization %}{{contestant.performer.group.organization}}{%endif %}<br>
                  {{contestant.performer.group.chapter.name}}
                </td>
                <td>
                  {% for performance in contestant.performer.performances.all %}
                    {% for song in performance.songs.all %}
                      {{song.title}}<br>
                    {% endfor %}
                    {% if contestant.performer.performances.count > 1%}<em>{{performance.round.get_kind_display}}</em><br>{% endif %}
                  {% endfor %}
                <strong>Totals</strong>
                </td>
                <td>
                  {% for performance in contestant.performer.performances.all %}
                    {% for song in performance.songs.all %}
                      {{song.mus_points}}<br>
                    {% endfor %}
                    {% if contestant.performer.performances.count > 1%}<em>{{performance.mus_points}}</em><br>{% endif %}
                  {% endfor %}
                <strong>{{contestant.mus_points}}</strong>
                </td>
                <td>
                  {% for performance in contestant.performer.performances.all %}
                    {% for song in performance.songs.all %}
                      {{song.prs_points}}<br>
                    {% endfor %}
                    {% if contestant.performer.performances.count > 1%}<em>{{performance.prs_points}}</em><br>{% endif %}
                  {% endfor %}
                <strong>{{contestant.prs_points}}</strong>
                </td>
                <td>
                  {% for performance in contestant.performer.performances.all %}
                    {% for song in performance.songs.all %}
                      {{song.sng_points}}<br>
                    {% endfor %}
                    {% if contestant.performer.performances.count > 1%}<em>{{performance.sng_points}}</em><br>{% endif %}
                  {% endfor %}
                <strong>{{contestant.sng_points}}</strong>
                </td>
                <td>
                  {% for performance in contestant.performer.performances.all %}
                    {% for song in performance.songs.all %}
                      {{song.total_points}}<br>
                    {% endfor %}
                    {% if contestant.performer.performances.count > 1%}<em>{{performance.total_points}}</em><br>{% endif %}
                  {% endfor %}
                <strong>{{contestant.total_points}}</strong>
                </td>
                <td>
                  {% for performance in contestant.performer.performances.all %}
                    {% for song in performance.songs.all %}
                      {{song.mus_score}}<br>
                    {% endfor %}
                    {% if contestant.performer.performances.count > 1%}<em>{{performance.mus_score}}</em><br>{% endif %}
                  {% endfor %}
                <strong>{{contestant.mus_score}}</strong>
                </td>
                <td>
                  {% for performance in contestant.performer.performances.all %}
                    {% for song in performance.songs.all %}
                      {{song.prs_score}}<br>
                    {% endfor %}
                    {% if contestant.performer.performances.count > 1%}<em>{{performance.prs_score}}</em><br>{% endif %}
                  {% endfor %}
                <strong>{{contestant.prs_score}}</strong>
                </td>
                <td>
                  {% for performance in contestant.performer.performances.all %}
                    {% for song in performance.songs.all %}
                      {{song.sng_score}}<br>
                    {% endfor %}
                    {% if contestant.performer.performances.count > 1%}<em>{{performance.sng_score}}</em><br>{% endif %}
                  {% endfor %}
                <strong>{{contestant.sng_score}}</strong>
                </td>
                <td>
                  {% for performance in contestant.performer.performances.all %}
                    {% for song in performance.songs.all %}
                      {{song.total_score}}<br>
                    {% endfor %}
                    {% if contestant.performer.performances.count > 1%}<em>{{performance.total_score}}</em><br>{% endif %}
                  {% endfor %}
                <strong>{{contestant.total_score}}</strong>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
    <section>
      <h4>Award</h4>
        <p>{{contest.award.name}} Champion: {{champion.name}}</p>
    </section>
    <section>
      <h4>Judges</h4>
      <div class='table-responsive'>
        <table class='table'>
          {% regroup judges by get_category_display as judges_list %}
          <tbody>
            {% for get_category_display in judges_list %}
            <tr>
              {% for judge in get_category_display.list %}
                <td>{{judge.person.common_name}}, {{judge.designation}}</td>
              {% endfor %}
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
  </main>
{% endblock content %}
