<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet">
    <style type="text/css">
      body {
        font-family: 'Inconsolata', monospace;
        margin: 20px;
      }
      table tr {
        white-space:nowrap;
      }
      table td {
        line-height: 14px !important;
      }
      strong {
        font-family: 'Inconsolata', monospace;
        font-weight: 700 !important;
      }
      .small_logo {
          height: 50px;
      }
      .pbi_avoid {
          page-break-inside: avoid !important;
      }
      .col-success {
        background-color: #dff0d8;
      }
      .col-warning {
        background-color: #fcf8e3;
      }
      .col-info {
        background-color: #d9edf7;
      }
      .b-right {
        border-right: 1px solid gray;
        border-left: 1px solid gray;
      }
    </style>
  </head>
  <body>
      <div class='row'>
        <img class='pull-right small_logo' src="https://barberscore-api.herokuapp.com/static/api/bhs_logo.png">
        {% if round.session.convention.image %}
          <img class='pull-right small_logo' src="{{round.session.convention.image.url}}">
        {% endif %}
        <h4>
          Scoring Analysis {{round.session.get_kind_display}} {{round.get_kind_display}}<br>
          {{round.session.convention.name}}
        </h4>
        <h5>
          {{round.session.convention.location}}; {{round.session.convention.start_date|date:"F j, Y"}} - {{round.session.convention.end_date|date:"F j, Y"}}
        </h5>
      </div>
    <section>
      <table class='table table-condensed'>
        <colgroup>
          <col span=3>
          <col span=1 class='col-warning b-right'>
          {% for person in persons_music %}
            <col span=1 class='col-warning'>
          {% endfor %}
          <col span=1 class='col-success b-right'>
          {% for person in persons_performance %}
            <col span=1 class='col-success'>
          {% endfor %}
          <col span=1 class='col-info b-right'>
          {% for person in persons_singing %}
            <col span=1 class='col-info'>
          {% endfor %}
        </colgroup>
        <thead>
          <th>Competitor</th>
          <th>Songs</th>
          <th class='text-center'>TOT</th>
          <th class='text-center'>MUS</th>
          {% for person in persons_music %}
            {% if person.practice %}
              <th class='text-right'><em>{{person.initials}}</em></th>
                {% else %}
              <th class='text-right'>{{person.initials}}</th>
            {% endif %}
          {% endfor %}
          <th class='text-center'>PER</th>
          {% for person in persons_performance %}
            {% if person.practice %}
              <th class='text-right'><em>{{person.initials}}</em></th>
                {% else %}
              <th class='text-right'>{{person.initials}}</th>
            {% endif %}
          {% endfor %}
          <th class='text-center'>SNG</th>
          {% for person in persons_singing %}
            {% if person.practice %}
              <th class='text-right'><em>{{person.initials}}</em></th>
                {% else %}
              <th class='text-right'>{{person.initials}}</th>
            {% endif %}
          {% endfor %}
        </thead>
        <tbody>
          {% for group in groups %}
            <tr>
              <td>
                <strong>{{group.name}}</strong>&nbsp;({{group.representing|default:"UNK"}})<br>
                {% if group.max == 1 %}
                  Finals:&nbsp;{{group.tot_points}}&nbsp;({{group.tot_score|floatformat:1}})&nbsp;{% for appearance in group.appearances_patched %}OA:&nbsp;{{appearance.num}}{% endfor %}<br>
                {% else %}
                  Total:&nbsp;{{group.tot_points}}&nbsp;({{group.tot_score|floatformat:1}})<br>
                    {% for appearance in group.appearances_patched %}
                      {{appearance.round_patched}}:&nbsp;{{appearance.tot_points}}&nbsp;({{appearance.tot_score|floatformat:1}})&nbsp;OA:&nbsp;{{appearance.num}}<br>
                  {% endfor %}
                {% endif %}
              </td>
              <td>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {{song.chart.nomen|truncatechars_html:50|safe|default:"(Song not included in contestant repertory)"}}&nbsp;{{song.penalties_patched}}<br>
                  {% endfor %}
                {% endfor %}
              </td>
              <td class='text-right'>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {{song.tot_points}}&nbsp;({{song.tot_score|floatformat:1}})&nbsp;{{song.tot_dev|floatformat:1}}<br>
                  {% endfor %}
                {% endfor %}
              </td>
              <td class='text-right'>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {% if song.mus_variance %}
                      <strong>{{song.mus_points}}&nbsp;({{song.mus_score|floatformat:1}})&nbsp;{{song.mus_dev|floatformat:1}}<br></strong>
                    {% else %}
                      {{song.mus_points}}&nbsp;({{song.mus_score|floatformat:1}})&nbsp;{{song.mus_dev|floatformat:1}}<br>
                    {% endif %}
                  {% endfor %}
                {% endfor %}
              </td>
              {% for col in group.music_patched %}
                <td class='text-right'>
                  {% for score in col %}
                    {% if score.panelist.kind == 20 %}
                      <em>{{score.points}}</em><br>
                    {% else %}
                      {{score.points}}<br>
                    {% endif %}
                  {% endfor %}
                </td>
              {% endfor %}
              <td class='text-right'>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {% if song.per_variance %}
                      <strong>{{song.per_points}}&nbsp;({{song.per_score|floatformat:1}})&nbsp;{{song.per_dev|floatformat:1}}<br></strong>
                    {% else %}
                      {{song.per_points}}&nbsp;({{song.per_score|floatformat:1}})&nbsp;{{song.per_dev|floatformat:1}}<br>
                    {% endif %}
                  {% endfor %}
                {% endfor %}
              </td>
              {% for col in group.performance_patched %}
                <td class='text-right'>
                  {% for score in col %}
                    {% if score.panelist.kind == 20 %}
                      <em>{{score.points}}</em><br>
                    {% else %}
                      {{score.points}}<br>
                    {% endif %}
                  {% endfor %}
                </td>
              {% endfor %}
              <td class='text-right'>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {% if song.sng_variance %}
                      <strong>{{song.sng_points}}&nbsp;({{song.sng_score|floatformat:1}})&nbsp;{{song.sng_dev|floatformat:1}}<br></strong>
                    {% else %}
                      {{song.sng_points}}&nbsp;({{song.sng_score|floatformat:1}})&nbsp;{{song.sng_dev|floatformat:1}}<br>
                    {% endif %}
                  {% endfor %}
                {% endfor %}
              </td>
              {% for col in group.singing_patched %}
                <td class='text-right'>
                  {% for score in col %}
                    {% if score.panelist.kind == 20 %}
                      <em>{{score.points}}</em><br>
                    {% else %}
                      {{score.points}}<br>
                    {% endif %}
                  {% endfor %}
                </td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
    <section>
      <div class='row'>
        {% comment %}
        <div class='col-xs-1'>
          <ul class='list-unstyled'>
            Overall StDev Average:
            <li><strong>TOT</strong>:&nbsp;{{stats.tot|floatformat:1}}</li>
            <li><strong>MUS</strong>:&nbsp;{{stats.mus|floatformat:1}}</li>
            <li><strong>PER</strong>:&nbsp;{{stats.per|floatformat:1}}</li>
            <li><strong>SNG</strong>:&nbsp;{{stats.sng|floatformat:1}}</li>
          </ul>
        </div>
        {% endcomment %}
        <div class='col-xs-3'>
          Total (Average StDev {{stats.tot|floatformat:1}})<br>
          Original Variances in <strong>Bold</strong>.<br>
          Practice Judges in <em>Italics</em>.<br>
        </div>

        <div class='col-xs-3'>
          <ul class='list-unstyled'>
            Music (Average StDev {{stats.mus|floatformat:1}}):
            {% for person in persons_music %}
              {% if person.practice %}
                <li><em>{{person.common_name}}</em></li>
              {% else %}
                <li>{{person.common_name}}</li>
              {% endif %}
            {% endfor %}
          </ul>
        </div>
        <div class='col-xs-3'>
          <ul class='list-unstyled'>
            Performance (Average StDev {{stats.per|floatformat:1}}):
            {% for person in persons_performance %}
              {% if person.practice %}
                <li><em>{{person.common_name}}</em></li>
              {% else %}
                <li>{{person.common_name}}</li>
              {% endif %}
            {% endfor %}
          </ul>
        </div>
        <div class='col-xs-3'>
          <ul class='list-unstyled'>
            Singing (Average StDev {{stats.sng|floatformat:1}}):
            {% for person in persons_singing %}
              {% if person.practice %}
                <li><em>{{person.common_name}}</em></li>
              {% else %}
                <li>{{person.common_name}}</li>
              {% endif %}
            {% endfor %}
          </ul>
        </div>
      </div>
    </section>
  </body>
</html>



