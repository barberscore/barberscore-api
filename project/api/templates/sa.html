<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet">
    <style type="text/css">
      body {
        font-family: 'Inconsolata', monospace;
        margin: 20px;
      }
      table tr {
        white-space:nowrap;
      }
      table td {
        line-height: 14px !important;
      }
      strong {
        font-family: 'Inconsolata', monospace;
        font-weight: 700 !important;
      }
      .small_logo {
          height: 50px;
      }
      .pbi_avoid {
          page-break-inside: avoid !important;
      }
      .col-success {
        background-color: #dff0d8;
      }
      .col-warning {
        background-color: #fcf8e3;
      }
      .col-info {
        background-color: #d9edf7;
      }
    </style>
  </head>
  <body>
      <div class='row'>
        <img class='pull-right small_logo' src="https://barberscore-api.herokuapp.com/static/api/bhs_logo.png">
        {% if round.session.convention.image %}
          <img class='pull-right small_logo' src="{{round.session.convention.image.url}}">
        {% endif %}
        <h4>
          Scoring Analysis {{round.session.get_kind_display}} {{round.get_kind_display}}<br>
          {{round.session.convention.name}}
        </h4>
        <h5>
          {{round.session.convention.location}}; {{round.session.convention.start_date|date:"F j, Y"}} - {{round.session.convention.end_date|date:"F j, Y"}}
        </h5>
      </div>
    <section>
      <table class='table table-condensed'>
        {% comment %}
        <colgroup>
          <col span=3>
          <col span=1 class='col-warning'>
          {% for person in persons %}
            {% if person.category_patched == 'Music' %}
              <col span=1 class='col-warning'>
            {% endif %}
          {% endfor %}
          <col span=1 class='col-success'>
          {% for person in persons %}
            {% if person.category_patched == 'Performance' %}
              <col span=1 class='col-success'>
            {% endif %}
          {% endfor %}
          <col span=1 class='col-info'>
          {% for person in persons %}
            {% if person.category_patched == 'Singing' %}
              <col span=1 class='col-info'>
            {% endif %}
          {% endfor %}
        </colgroup>
        {% endcomment %}
        <thead>
          <th>Competitor</th>
          <th>Songs</th>
          <th class='text-right'>TOT</th>
          <th class='text-right'>MUS</th>
          {% for person in persons_music %}
            <th class='text-right'>{{person.initials}}</th>
          {% endfor %}
          <th class='text-right'>PER</th>
          {% for person in persons_performance %}
            <th class='text-right'>{{person.initials}}</th>
          {% endfor %}
          <th class='text-right'>SNG</th>
          {% for person in persons_singing %}
            <th class='text-right'>{{person.initials}}</th>
          {% endfor %}
        </thead>
        <tbody>
          {% for group in groups %}
            <tr>
              <td>
                <strong>{{group.name}}</strong>&nbsp;({{group.representing|default:"UNK"}})<br>
                {% if group.max == 1 %}
                  Finals:&nbsp;{{group.tot_points}}&nbsp;({{group.tot_score|floatformat:1}})&nbsp;{% for appearance in group.appearances_patched %}OA:&nbsp;{{appearance.num}}{% endfor %}<br>
                {% else %}
                  Total:&nbsp;{{group.tot_points}}&nbsp;({{group.tot_score|floatformat:1}})<br>
                    {% for appearance in group.appearances_patched %}
                      {{appearance.round_patched}}:&nbsp;{{appearance.tot_points}}&nbsp;({{appearance.tot_score|floatformat:1}})&nbsp;OA:&nbsp;{{appearance.num}}<br>
                  {% endfor %}
                {% endif %}
              </td>
              <td>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {{song.chart.nomen|truncatechars_html:50|safe|default:"(Song not included in contestant repertory)"}}&nbsp;{{song.penalties_patched}}<br>
                  {% endfor %}
                {% endfor %}
              </td>
              <td class='text-right'>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {{song.tot_points}}&nbsp;({{song.tot_score|floatformat:1}})&nbsp;{{song.tot_dev|floatformat:1}}<br>
                  {% endfor %}
                {% endfor %}
              </td>
              <td class='text-right'>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {{song.mus_points}}&nbsp;({{song.mus_score|floatformat:1}})&nbsp;{{song.mus_dev|floatformat:1}}<br>
                  {% endfor %}
                {% endfor %}
              </td>
              {% for col in group.music_patched %}
                <td class='text-right'>
                  {% for score in col %}
                    {{score.points}}<br>
                  {% endfor %}
                </td>
              {% endfor %}
              <td class='text-right'>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {{song.per_points}}&nbsp;({{song.per_score|floatformat:1}})&nbsp;{{song.per_dev|floatformat:1}}<br>
                  {% endfor %}
                {% endfor %}
              </td>
              {% for col in group.performance_patched %}
                <td class='text-right'>
                  {% for score in col %}
                    {{score.points}}<br>
                  {% endfor %}
                </td>
              {% endfor %}
              <td class='text-right'>
                {% for appearance in group.appearances_patched %}
                  {% for song in appearance.songs_patched %}
                    {{song.sng_points}}&nbsp;({{song.sng_score|floatformat:1}})&nbsp;{{song.sng_dev|floatformat:1}}<br>
                  {% endfor %}
                {% endfor %}
              </td>
              {% for col in group.singing_patched %}
                <td class='text-right'>
                  {% for score in col %}
                    {{score.points}}<br>
                  {% endfor %}
                </td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
    <section>
      <div class='row'>
        <div class='pull-right'>
          <ul class='list-inline'>
            Scoring Panel:
            {% for person in persons %}
              <li>{{person.common_name}}</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </section>
  </body>
</html>



